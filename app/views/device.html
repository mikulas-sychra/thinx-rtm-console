<!-- BEGIN PAGE BREADCRUMB -->
<ul class="page-breadcrumb breadcrumb">
  <li>
    <a ui-sref="dashboard">Home</a>
    <i class="fa fa-circle"></i>
  </li>
  <li>
    <a ui-sref="dashboard">Dashboard</a>
    <i class="fa fa-circle"></i>
  </li>
  <li class="active"> Device </li>
</ul>
<!-- END PAGE BREADCRUMB -->
<!-- BEGIN MAIN CONTENT -->
<div>

  <!-- BEGIN FORM-->
  <form action="#" class="form-horizontal form-bordered" name="deviceModalForm">
    <div id="deviceModal">

            <div class="form-group">
              <label class="control-label col-md-3">Platform</label>
              <div class="col-md-9">
                <ui-select ng-model="deviceForm.platform" theme="bootstrap" title="Choose platfourm">
                  <ui-select-match placeholder="Select platform from the list...">
                    <img ng-src="../assets/thinx/img/external/{{$select.selected.id}}_logo_200.png" class="platform-icon-sm pull-left {{$select.selected.id}}-platform-color" alt="{{$select.selected.id}} icon" />
                    {{$select.selected.value.name}}
                  </ui-select-match>
                  <ui-select-choices repeat="platform.id as (id, platform) in $root.platforms | filter:$select.search">
                    <img ng-src="../assets/thinx/img/external/{{platform.id}}_logo_200.png" class="platform-icon pull-left {{platform.id}}-platform-color" alt="{{platform.id}} icon" />
                    <div class="platform-title" ng-bind-html="platform.value.name | highlight: $select.search"></div><br>
                  </ui-select-choices>
                </ui-select>
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-md-3">Category</label>
              <div class="col-md-9">
                <ui-select ng-model="deviceForm.category" theme="bootstrap" title="Choose category">
                  <ui-select-match placeholder="Select category from the list...">
                    <i class="pull-left bg-{{$select.selected.id}} color-dot-out" alt="{{$select.selected.value.name}}"></i>
                    {{$select.selected.value.name}}
                  </ui-select-match>
                  <ui-select-choices repeat="category.id as (id, category) in $root.categories | filter:$select.search">
                    <i class="pull-left bg-{{category.id}} color-dot" alt="{{category.value.name}}"></i>
                    <div ng-bind-html="category.value.name | highlight: $select.search"></div>
                  </ui-select-choices>
                </ui-select>
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-md-3">Tags</label>
              <div class="col-md-9">
                <ui-select multiple tagging tagging-label="(create new tag)" ng-model="deviceForm.tags" theme="bootstrap" sortable="true" title="Enter tag">
                  <ui-select-match placeholder="Select or enter tags...">
                    <span class="device-tag">{{$item}}</span>
                  </ui-select-match>
                  <ui-select-choices repeat="tag in $root.profile.info.tags | filter:$select.search track by $index">
                    {{tag}}
                  </ui-select-choices>
                </ui-select>
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-md-3">Alias</label>
              <div class="col-md-9">
                <input type="text" ng-model="deviceForm.alias" name="deviceAlias" class="form-control" />
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-md-3">Description</label>
              <div class="col-md-9">
                <input type="text" ng-model="deviceForm.description" name="deviceDescription" class="form-control" />
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-md-3">API Key</label>
              <div class="col-md-9">
                <div class="input-group">
                  <ui-select ng-model="deviceForm.keyhash" theme="bootstrap" title="Choose a key">
                    <ui-select-match placeholder="Select key in the list...">{{$select.selected.value.alias}}</ui-select-match>
                    <ui-select-choices repeat="apikey.value.hash as (key, apikey) in $root.apikeys | filter: { value: { alias: $select.search }}">
                      <div ng-bind-html="apikey.value.alias | highlight: $select.search"></div>
                      <small>{{apikey.value.hash | limitTo: 6 }}</small>
                    </ui-select-choices>
                  </ui-select>
                  <span class="input-group-btn">
                    <button type="button" ng-click="deviceForm.keyhash = null" class="btn btn-default"><span class="fa fa-chain-broken"></span></button>
                  </span>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-md-3">Source</label>
              <div class="col-md-9">
                <div class="input-group">
                  <ui-select ng-model="deviceForm.source" theme="bootstrap" title="Choose a source" on-select="attachSource($select.selected.value.sourceId, deviceForm.udid)">
                    <ui-select-match placeholder="Select source in the list..."><div class="badge platform-badge {{$select.selected.value.platform}}-platform-color" style="float: right; margin-top: 2px;">{{$root.platforms[$select.selected.value.platform].name}}</div> {{$select.selected.value.alias}}</ui-select-match>
                    <ui-select-choices repeat="source.value.sourceId as (key, source) in $root.sources | filter: { value: { alias: $select.search }}">
                      <div>
                        <span ng-bind-html="source.value.alias | highlight: $select.search"></span>
                        <span class="badge {{source.value.platform}}-platform-color platform-badge">{{$root.platforms[source.value.platform].name}}</span>
                      </div>
                      <small>{{source.value.url}}</small>
                    </ui-select-choices>
                  </ui-select>
                  <span class="input-group-btn">
                    <button type="button" ng-click="detachSource(deviceForm.udid)" class="btn btn-default"><span class="fa fa-chain-broken"></span></button>
                  </span>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-md-3">Auto Update</label>
              <div class="col-md-9">
                <input
                bs-switch
                ng-model="deviceForm.auto_update"
                type="checkbox"
                switch-size="tiny"
                switch-on-text="On"
                switch-off-text="Off"
                ng-true-value="true"
                ng-false-value="false">
              </div>
            </div>
            <div class="form-group last">
              <label class="control-label col-md-3">MQTT Channel</label>
              <div class="col-md-9">
                <div class="input-group">
                  <input type="text" id="mqtt" name="mqtt" class="form-control" ng-value="'/' + $root.profile.owner + '/' + deviceForm.udid" ng-readonly="true" />
                  <span class="input-group-btn">
                    <button type="button" ng-click="copyToClipboard(deviceForm.udid)" class="btn btn-default copy-btn" data-clipboard-target="#mqtt"><span class="fa fa-clipboard"></span></button>
                  </span>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" ng-click="submitDeviceForm()"><i class="fa fa-check"></i> Submit</button>
          </div>

    </div>

  </form>
  <!-- END FORM-->
</div>
<!-- END MAIN CONTENT -->

<!-- BEGIN MAIN JS & CSS -->
<script>
  new Clipboard('.copy-btn');
</script>
<!-- BEGIN MAIN JS & CSS
