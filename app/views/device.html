<!-- BEGIN PAGE BREADCRUMB -->
<ul class="page-breadcrumb breadcrumb">
  <li>
    <a ui-sref="dashboard">Home</a>
    <i class="fa fa-circle"></i>
  </li>
  <li>
    <a ui-sref="dashboard">Dashboard</a>
    <i class="fa fa-circle"></i>
  </li>
  <li class="active"> Device </li>
</ul>
<!-- END PAGE BREADCRUMB -->
<!-- BEGIN MAIN CONTENT -->

<!-- BEGIN PORTLET-->
<div class="portlet light bordered ">
  <div class="portlet-title">
    <div class="caption caption-md">
      <i class="icon-bulb font-red"></i>
      <span class="caption-subject font-red bold uppercase">Device</span>
    </div>
    <div class="actions">
      <button ui-sref="dashboard" class="btn grey-mint btn-outline btn-circle btn-sm"><i class="fa fa-arrow-left"></i></button>
    </div>
  </div>
  <div class="portlet-body" ng-if="deviceForm.udid != null">

    <div class="row" style="padding-bottom: 20px;">
      <div class="col-md-3">
      </div>
      <div class="col-md-9">
        <h2>
          <span editable-text="deviceForm.alias" editable-buttons="no" e-form="aliasBtnForm" onaftersave="submitDeviceFormChange('alias')">{{deviceForm.alias | limitTo: 24}}{{deviceForm.alias.length > 24 ? '…' : ''}}</span>
          <button style="border: 0" class="btn grey-mint btn-outline btn-circle btn-sm" ng-click="aliasBtnForm.$show()" ng-hide="aliasBtnForm.$visible"><i class="fa fa-pencil"></i></button>
        </h2>
        <div>
          <span editable-text="deviceForm.description" editable-buttons="no" e-form="descBtnForm" onaftersave="submitDeviceFormChange('description')">{{deviceForm.description | limitTo: 48}}{{deviceForm.description.length > 48 ? '…' : ''}}</span>
          <button style="border: 0" class="btn grey-mint btn-outline btn-circle btn-sm" ng-click="descBtnForm.$show()" ng-hide="descBtnForm.$visible"><i class="fa fa-pencil"></i></button>
        </div>
      </div>
    </div>

    <!-- BEGIN FORM-->
    <form class="form-horizontal form-bordered" name="deviceViewForm">

      <div class="row margin-bottom-30">
        <div class="col-md-12 col-sm-12 col-xs-12">

          <div class="form-group">
            <label class="control-label col-md-3"></label>
            <div class="col-md-9">
              <img ng-src="../assets/thinx/img/external/{{deviceForm.platform}}_logo_200.png" class="platform-icon pull-left {{deviceForm.platform}}-platform-color" alt="{{deviceForm.platform}} icon" />
              <div class="platform-title">{{$root.platforms[deviceForm.platform].name}}</div>
            </div>
          </div>
          <div class="form-group">
            <label class="control-label col-md-3">Category</label>
            <div class="col-md-9">
              <ui-select ng-model="deviceForm.category" theme="bootstrap" title="Choose category" ng-change="submitDeviceFormChange('category')">
                <ui-select-match placeholder="Select category from the list...">
                  <i class="pull-left bg-{{$select.selected.id}} color-dot-out" alt="{{$select.selected.value.name}}"></i>
                  {{$select.selected.value.name}}
                </ui-select-match>
                <ui-select-choices repeat="category.id as (id, category) in $root.categories | filter:$select.search">
                  <i class="pull-left bg-{{category.id}} color-dot" alt="{{category.value.name}}"></i>
                  <div ng-bind-html="category.value.name | highlight: $select.search"></div>
                </ui-select-choices>
              </ui-select>
            </div>
          </div>
          <div class="form-group">
            <label class="control-label col-md-3">Tags</label>
            <div class="col-md-9">
              <ui-select multiple tagging tagging-label="(create new tag)" ng-model="deviceForm.tags" theme="bootstrap" sortable="true" title="Enter tag"  ng-change="submitDeviceFormChange('tags')">
                <ui-select-match placeholder="Select or enter tags...">
                  <span class="device-tag">{{$item}}</span>
                </ui-select-match>
                <ui-select-choices repeat="tag in $root.profile.info.tags | filter:$select.search track by $index">
                  {{tag}}
                </ui-select-choices>
              </ui-select>
            </div>
          </div>

          <div class="form-group">
            <label class="control-label col-md-3">API Key</label>
            <div class="col-md-9">
              <div class="input-group">
                <ui-select ng-model="deviceForm.keyhash" theme="bootstrap" title="Choose a key" ng-change="submitDeviceFormChange('keyhash')">
                  <ui-select-match placeholder="Select key in the list...">{{$select.selected.value.alias}}</ui-select-match>
                  <ui-select-choices repeat="apikey.value.hash as (key, apikey) in $root.apikeys | filter: { value: { alias: $select.search }}">
                    <div ng-bind-html="apikey.value.alias | highlight: $select.search"></div>
                    <small>{{apikey.value.hash | limitTo: 6 }}</small>
                  </ui-select-choices>
                </ui-select>
                <span class="input-group-btn">
                  <button type="button" ng-click="deviceForm.keyhash = null; submitDeviceFormChange('keyhash')" class="btn btn-default"><span class="fa fa-chain-broken"></span></button>
                </span>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label class="control-label col-md-3">Source</label>
            <div class="col-md-9">
              <div class="input-group">
                <ui-select ng-model="deviceForm.source" theme="bootstrap" title="Choose a source" ng-change="attachSource($select.selected.value.sourceId, deviceForm.udid)">
                  <ui-select-match placeholder="Select source in the list..."><div class="badge platform-badge {{$select.selected.value.platform}}-platform-color" style="float: right; margin-top: 2px;">{{$root.platforms[$select.selected.value.platform].name}}</div> {{$select.selected.value.alias}}</ui-select-match>
                  <ui-select-choices repeat="source.value.sourceId as (key, source) in $root.sources | filter: { value: { alias: $select.search }}">
                    <div>
                      <span ng-bind-html="source.value.alias | highlight: $select.search"></span>
                      <span class="badge {{source.value.platform}}-platform-color platform-badge">{{$root.platforms[source.value.platform].name}}</span>
                    </div>
                    <small>{{source.value.url}}</small>
                  </ui-select-choices>
                </ui-select>
                <span class="input-group-btn">
                  <button type="button" ng-click="detachSource(deviceForm.udid)" class="btn btn-default"><span class="fa fa-chain-broken"></span></button>
                </span>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label class="control-label col-md-3">Auto Update</label>
            <div class="col-md-9">
              <input
              bs-switch
              ng-change="submitDeviceFormChange('auto_update')"
              ng-model="deviceForm.auto_update"
              type="checkbox"
              switch-size="tiny"
              switch-on-text="On"
              switch-off-text="Off"
              ng-true-value="true"
              ng-false-value="false">
            </div>
          </div>
          <div class="form-group last">
            <label class="control-label col-md-3">MQTT Channel</label>
            <div class="col-md-9">
              <div class="input-group">
                <input type="text" id="mqtt" name="mqtt" class="form-control" ng-value="'/' + $root.profile.owner + '/' + deviceForm.udid" ng-readonly="true" />
                <span class="input-group-btn">
                  <button type="button" ng-click="copyToClipboard(deviceForm.udid)" class="btn btn-default copy-btn" data-clipboard-target="#mqtt"><span class="fa fa-clipboard"></span></button>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </form>
    <!-- END FORM-->
  </div>
</div>
<!-- END PORTLET-->
<!-- END MAIN CONTENT -->
<!-- BEGIN MAIN JS & CSS -->
<script>
new Clipboard('.copy-btn');
</script>
<!-- BEGIN MAIN JS & CSS
